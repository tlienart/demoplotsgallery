<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/demoplotsgallery/libs/highlight/github.min.css"> <link rel=stylesheet  href="/demoplotsgallery/css/franklin.css"> <title>Demo Plots Gallery</title> <div class=franklin-content ><h1 id=demo_plots_gallery ><a href="#demo_plots_gallery" class=header-anchor >Demo Plots Gallery</a></h1> <h2 id=basic_stuff ><a href="#basic_stuff" class=header-anchor >Basic stuff</a></h2> <p>This doesn&#39;t require anything specific, just note the use of the macro <code>@OUTPUT</code> which creates a path for the image which you don&#39;t have to manage and that makes inputting the image easier.</p> <pre><code class="julia hljs">x = randn(<span class=hljs-number >10</span>)
y = randn(<span class=hljs-number >10</span>)
figure(figsize=(<span class=hljs-number >8</span>, <span class=hljs-number >6</span>))
plot(x, y, ls=<span class=hljs-string >&quot;none&quot;</span>, marker=<span class=hljs-string >&quot;x&quot;</span>, markersize=<span class=hljs-number >10</span>)</code></pre> <p>Inputting the fig is just as simple as <code>\fig&#123;f1.svg&#125;</code> no path needed:</p> <img src="/demoplotsgallery/assets/index/code/output/f1.svg" alt=""> <p>Some notes:</p> <ul> <li><p>locally, when you have multiple such code blocks, these only get executed once unless you modify something in the code or you modify some code in a cell <em>before</em> it &#40;as it can&#39;t assume that the current cell does not depend on anything from a previous cell&#41;.</p> <li><p>when you deploy, everything gets re-evaluated, if you have hundreds of plots this can take quite a while.</p> </ul> <p>If you don&#39;t care that the deployment is slow &#40;runs every cell every time&#41;, then this is probably all you need.</p> <h2 id=avoiding_re-evaluation ><a href="#avoiding_re-evaluation" class=header-anchor >Avoiding re-evaluation</a></h2> <p>This will get better in Franklin but, for now, the kind of stuff you could do to avoid re-evaluating everything when you deploy is:</p> <ul> <li><p>save figures to <code>_assets</code></p> <li><p>check if there&#39;s already an image corresponding to the code block and if so don&#39;t evaluate it</p> <li><p>otherwise evaluate it</p> </ul> <p>this quickly becomes a bit tricky as you have to keep track of whether an image needs to be updated or whether an image is orphaned &#40;has been generated but you don&#39;t need it anymore&#41;. This is doable though. The recommendation would be to have each code block generate a figure with exactly the name of the code block.</p> <pre><code class="julia hljs">x = collect(<span class=hljs-number >0</span>:<span class=hljs-number >0.1</span>:<span class=hljs-number >5</span>)
y = @. x * exp(-sin(x))
figure(figsize=(<span class=hljs-number >8</span>, <span class=hljs-number >6</span>))
plot(x, y)</code></pre> <img src="/demoplotsgallery/assets/index/code/output/fig1.svg" alt=""> <p>The function <code>lx_exfiga</code> does some of this.</p> <pre><code class="julia hljs"><span class=hljs-keyword >using</span> PyPlot
x = collect(<span class=hljs-number >0</span>:<span class=hljs-number >0.1</span>:<span class=hljs-number >5</span>)
y = @. cos(x) * exp(-sin(x))
figure(figsize=(<span class=hljs-number >8</span>, <span class=hljs-number >6</span>))
plot(x, y, lw=<span class=hljs-number >2</span>)</code></pre></p> <p><img src="/demoplotsgallery/assets/index/code/output/foo_1.svg" alt=""> <p>That function could be extended in the following way:</p> <ul> <li><p>the saved file could be copied to a specific location in <code>_assets</code> making the image uploaded at deployment &#40;so adding something like <code>cp&#40;joinpath&#40;@OUTPUT, &quot;&#36;fname&quot;&#41;, some_path_in_assets&#41;</code>&#41;</p> <li><p>the function could check a priori whether <code>some_path_in_assets</code> exists, if it does, skip evaluation &#40;by not writing the code cell, just writing the <code>\\fig</code>&#41; part.</p> </ul> <p>I&#39;m not doing this here as I&#39;m not 100&#37; sure you want to go down this road, you might be fine with evaluation at every deployment.</p> <h2 id=generating_a_list_of_all_plots ><a href="#generating_a_list_of_all_plots" class=header-anchor >Generating a list of all plots</a></h2> <p>As far as I understand, you&#39;d like to be able to have a list of plots and generate a gallery of thumbnails on which users can click and then they&#39;d see a specific page or code or whatever.</p> <p>I think potentially the easiest path here would be to leverage the name of things and call figures with something that looks like the path. So if you do <code>joinpath&#40;@OUTPUT, &quot;fig.svg&quot;&#41;</code> on <code>index.md</code>, that figure will be saved at</p> <pre><code class="julia hljs">_site/assets/index/code/output/fig.svg</code></pre>
<p>it then becomes relatively easy to just scrape all this by just exploiting the generated file names.</p>
<p>One thing though is that you want the evaluation of such a function to happen <em>last</em>, i.e. after all pages have been &#40;re&#41;processed. For this you just need to put a <code>@delay</code> in the definition of the hfun:</p>
<ul>
<li><a href="/demoplotsgallery/assets/hamburger.svg">/assets/hamburger.svg</a>
<li><a href="/demoplotsgallery/assets/index/code/output/f1.svg">/assets/index/code/output/f1.svg</a>
<li><a href="/demoplotsgallery/assets/index/code/output/fig1.svg">/assets/index/code/output/fig1.svg</a>
<li><a href="/demoplotsgallery/assets/index/code/output/foo_1.svg">/assets/index/code/output/foo_1.svg</a>
<li><a href="/demoplotsgallery/assets/page2/code/output/foo.svg">/assets/page2/code/output/foo.svg</a>
</ul>
<p>you might want to add some further filtering to this etc but I&#39;m hoping this shows some of the stuff you could do.</p>
<div class=page-foot >
  <div class=copyright >
    &copy; The Oracle. Last modified: July 17, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div>